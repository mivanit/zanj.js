<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ZANJ demo</title>
  </head>
  <body>
    <h3>demo minimal</h3>
    <!-- <input id="base" value="demo" /> -->
    path: <span id="base"></span>
    <button id="load">load</button>
    <button id="big_array" disabled>load big_array</button>
    <button id="big_list" disabled>load big_list</button>
    <pre id="out"></pre>

    <script src="src/array.js"></script>
    <script src="src/zanj.js"></script>
    <script>
      BASE_PATH = "demo";
      document.getElementById("base").textContent = BASE_PATH;
      
      const out = document.getElementById("out");
      const log = (t) => out.textContent += t + "\n";

      let data = null;

      document.getElementById("load").onclick = async () => {
        log("loading from " + BASE_PATH);
        try {
          data = await (new ZanjLoader({ baseUrl: BASE_PATH })).loadRoot();
          log("keys: " + Object.keys(data).join(", "));
          document.getElementById("big_array").disabled = false;
          document.getElementById("big_list").disabled = false;

        } catch (e) {
          log("error: " + e);
        }
      };

      document.getElementById("big_array").onclick = async () => {
        log("fetching big_array.npy ...");
        const arr = await data.big_array.load();
        log("big_array.shape = " + arr.shape);
        log("big_array.dtype = " + arr.dtype);
        log("big_array[0] = " + arr.data[0]);
      };

      document.getElementById("big_list").onclick = async () => {
        log("fetching big_list ...");
        const lst = await data.big_list.load();
        log("len(big_list) = " + lst.length)
        log("big_list[0] = " + lst[0]);
      };
    </script>
  </body>
</html>
